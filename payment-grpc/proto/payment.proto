syntax = "proto3";

package payment;

option go_package = "github.com/Edbeer/payment-grpc/proto;paymentpb";

import "google/protobuf/timestamp.proto";

service PaymentService {
    rpc CreatePayment(Payment) returns (StatementResponse) {}
    rpc CapturePayment(Payment) returns (StatementResponse) {}
    rpc CancelPayment(Payment) returns (StatementResponse) {}
    rpc RefundPayment(Payment) returns (StatementResponse) {}
    rpc GetStatemet(StatementRequest) returns (stream StatementResponse) {}
}

message Payment {
    string payment_id = 1;
    string payment_receiver = 2;
    string payer = 3;
    Currencies currency = 4;
    Operations operation = 5;
    Statuses status = 6;
    double amount = 7;
    google.protobuf.Timestamp created_at = 8;
}

message Account {
    string id = 1;
    string first_name = 2;
    string last_name = 3;
    string card_number = 4;
    string card_expiry_month = 5;
    string card_expiry_year = 6;
    string card_security_code = 7;
    uint64 balance = 8;
    uint64 blocked_money = 9;
    repeated StatementResponse statement = 10;
    google.protobuf.Timestamp created_at = 11;
}

message StatementRequest {
    string account_id = 1;
}

message StatementResponse {
    string payment_id = 1;
    string status = 2;
}

enum Currencies {
    RUB = 0;
    USD = 1;
    EUR = 2;
}

enum Operations {
    AUTHORIZATION = 0;
    CAPTURE = 1;
    CANCEL = 2;
    REFUND = 3;
}

enum Statuses {
    APPROVED = 0;
    SUCCESSFUL_PAYMENT = 1;
    INSUFFICIENT_FUNDS = 2;
    INVALID_AMOUNT = 3;
    SUCCESSFUL_CANCEL = 4;
    SUCCESSFUL_REFUND = 5;
}